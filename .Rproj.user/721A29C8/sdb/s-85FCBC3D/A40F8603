{
    "collab_server" : "",
    "contents" : "---\noutput: \n  flexdashboard::flex_dashboard:\n    orientation: rows\n    vertical_layout: scroll\n    pandoc_args: [\n      \"+RTS\", \"-K64m\",\n      \"-RTS\"\n    ]\nruntime: shiny\n---\n\n```{r , include=FALSE}\n\n#install.packages(\"flexdashboard\")\n#install.packages(\"DT\")\n  library(flexdashboard)\n  library(jsonlite)\n  library(dplyr)\n  library(ggplot2)\n  library(highcharter)\n  library(geojsonio)\n  library(lubridate)\n  library(tabulizer)\n  library(stringr)\n  library(gsubfn)\n  library(DT)\n\n```\n\n\n```{r, include=FALSE}\ncar_makes <- c(\"ACURA\",\"AM GENERAL\",\"AMERICAN IRONHORSE\",\"APRILIA\",\"ARCTIC CAT\",\"ASTON MARTIN\",\"ATK\",\"AUDI\",\"AVANTI\",\"BENTLEY\",\"BIG DOG\",\"BIMOTA\",\"BLUE BIRD\",\"BMW\",\"BOMBARDIER\",\"BUELL\",\"BUICK\",\"CADILLAC\",\"CANNONDALE\",\"CHANCE COACH TRANSIT BUS\",\"CHEVROLET\",\"CHRYSLER\",\"COBRA\",\"DAEWOO\",\"DODGE\",\"DUCATI\",\"E-TON\",\"EL DORADO\",\"FERRARI\",\"FORD\",\"FREIGHTLINER\",\"GAS GAS\",\"GILLIG\",\"GMC\",\"HARLEY DAVIDSON\",\"HINO\",\"HM\",\"HONDA\",\"HUSABERG\",\"HUSQVARNA\",\"HYUNDAI\",\"INDIAN\",\"INFINITI\",\"INTERNATIONAL\",\"ISUZU\",\"JAGUAR\",\"JEEP\",\"KAWASAKI\",\"KENWORTH\",\"KIA\",\"KTM\",\"KYMCO\",\"LAFORZA\",\"LAMBORGHINI\",\"LANDROVER\",\"LEXUS\",\"LINCOLN\",\"LOTUS\",\"MACK\",\"MAZDA\",\"MERCEDES-BENZ\",\"MERCURY\",\"MITSUBISHI\",\"MITSUBISHI FUSO\",\"MOTO GUZZI\",\"MOTOR COACH INDUSTRIES\",\"MV AGUSTA\",\"NEW FLYER\",\"NISSAN\",\"NOVA BUS CORPORATION\",\"OLDSMOBILE\",\"ORION BUS\",\"OSHKOSH MOTOR TRUCK CO.\",\"OTTAWA\",\"PANOZ\",\"PETERBILT\",\"PEUGEOT\",\"PLYMOUTH\",\"POLARIS\",\"PONTIAC\",\"PORSCHE\",\"QVALE\",\"RENAULT\",\"ROLLS ROYCE\",\"SAAB\",\"SATURN\",\"SEA-DOO\",\"SEAT\",\"SKI-DOO\",\"STERLING\",\"STERLING TRUCK\",\"SUBARU\",\"SUZUKI\",\"TM\",\"TOYOTA\",\"TRIUMPH\",\"UD\",\"VICTORY\",\"VOLKSWAGEN\",\"VOLVO\",\"WESTERN STAR\",\"WORKHORSE\",\"YAMAHA\",\"ALFA ROMEO\",\"AUTOCAR LLC.\",\"COUNTRY COACH MOTORHOME\",\"HUMMER\",\"KASEA\",\"LEM\",\"MASERATI\",\"MINI\",\"MORGAN\",\"SALEEN\",\"WESTERN RV\",\"MAYBACH\",\"ROVER\",\"VENTO\",\"FIAT\",\"JOHN DEERE\",\"KUBOTA\",\"SCION\",\"SMART\",\"VESPA\",\"HYOSUNG\",\"PIAGGIO\",\"ARGO\",\"BUGATTI\",\"PIERCE MFG. INC.\",\"AMERICAN LAFRANCE\",\"CAN-AM\",\"CRANE CARRIER\",\"CUB CADET\",\"BETA\",\"BOBCAT\",\"TESLA\",\"RAM\",\"VPG\",\"CODA\",\"FISKER\",\"MCLAREN\",\"SRT\",\"BERTONE\",\"IC CORPORATION\",\"NASH\")\n```\n\n\n```{r Feature extaction, include=FALSE}\n\n\n\n\n# The goal here is to run through all the folders and subfolders, read each PDF, extract the key features, and store into a data frame\n\n\nFile_Name <- character()\nVehicle_make <- character()\nError_code_list <- list()\nError_text_list <-  list()\nAll_error_codes <- character()\nAll_error_texts <- character()\n\n\n\n# Feature extraction\n\ni=1\n\nfor (file_name in dir(path = \"./Inputs/PDF/\",pattern = \"^.*Diagnostic.*\\\\.pdf\",full.names=TRUE,recursive=TRUE)){\n  \n\n  \n  #Extract text from PDF\n  out_text <- extract_text(file_name)\n  #Basic text cleansing to enmable text recognition\n  out_text <- gsub(\"\\\\\",\"\", out_text,fixed=TRUE)\n  out_text_words <- unique(strsplit(paste(out_text, collapse = \" \"), ' ')[[1]])\n  out_text_words <- gsub(\"\\r\",\"\",out_text_words)\n  out_text_words <- gsub(\"\\n\",\"\",out_text_words)\n  \n  #Extract feature from cleansed text\n\n  error_codes <- as.vector(unique (grep(\".....\\\\-\\\\d\\\\d\", out_text_words, value=TRUE)))\n  car_make <- ifelse(length(intersect(out_text_words,car_makes)) == 0,\"Not found\",intersect(out_text_words,car_makes)) # to avoid zero length error\n  error_texts <- as.vector(unique(strapplyc(out_text, \".....\\\\-\\\\d\\\\d(.*?)(\\r\\n|\\r|\\n).*\", simplify = c)))\n  \n  \n  \n  File_Name[i] <- file_name\n  Vehicle_make[i] <- car_make\n  Error_code_list[[length(Error_code_list)+1]] <- error_codes\n  Error_text_list[[length(Error_text_list)+1]] <- error_texts\n  All_error_codes <- c(All_error_codes,error_codes)\n  All_error_texts <- c(All_error_texts,error_texts)\n  \n  \n  i <- i+1\n  \n}\n\nfeatures_df <- data.frame(cbind(File_Name,Vehicle_make,Error_code_list,Error_text_list))\n\n\n```\n\n\n```{r Selectors choices prep}\n\ncar_makes_list <- c(\"ACURA\",\"AM GENERAL\",\"AMERICAN IRONHORSE\",\"APRILIA\",\"ARCTIC CAT\",\"ASTON MARTIN\",\"ATK\",\"AUDI\",\"AVANTI\",\"BENTLEY\",\"BIG DOG\",\"BIMOTA\",\"BLUE BIRD\",\"BMW\",\"BOMBARDIER\",\"BUELL\",\"BUICK\",\"CADILLAC\",\"CANNONDALE\",\"CHANCE COACH TRANSIT BUS\",\"CHEVROLET\",\"CHRYSLER\",\"COBRA\",\"DAEWOO\",\"DODGE\",\"DUCATI\",\"E-TON\",\"EL DORADO\",\"FERRARI\",\"FORD\",\"FREIGHTLINER\",\"GAS GAS\",\"GILLIG\",\"GMC\",\"HARLEY DAVIDSON\",\"HINO\",\"HM\",\"HONDA\",\"HUSABERG\",\"HUSQVARNA\",\"HYUNDAI\",\"INDIAN\",\"INFINITI\",\"INTERNATIONAL\",\"ISUZU\",\"JAGUAR\",\"JEEP\",\"KAWASAKI\",\"KENWORTH\",\"KIA\",\"KTM\",\"KYMCO\",\"LAFORZA\",\"LAMBORGHINI\",\"LANDROVER\",\"LEXUS\",\"LINCOLN\",\"LOTUS\",\"MACK\",\"MAZDA\",\"MERCEDES-BENZ\",\"MERCURY\",\"MITSUBISHI\",\"MITSUBISHI FUSO\",\"MOTO GUZZI\",\"MOTOR COACH INDUSTRIES\",\"MV AGUSTA\",\"NEW FLYER\",\"NISSAN\",\"NOVA BUS CORPORATION\",\"OLDSMOBILE\",\"ORION BUS\",\"OSHKOSH MOTOR TRUCK CO.\",\"OTTAWA\",\"PANOZ\",\"PETERBILT\",\"PEUGEOT\",\"PLYMOUTH\",\"POLARIS\",\"PONTIAC\",\"PORSCHE\",\"QVALE\",\"RENAULT\",\"ROLLS ROYCE\",\"SAAB\",\"SATURN\",\"SEA-DOO\",\"SEAT\",\"SKI-DOO\",\"STERLING\",\"STERLING TRUCK\",\"SUBARU\",\"SUZUKI\",\"TM\",\"TOYOTA\",\"TRIUMPH\",\"UD\",\"VICTORY\",\"VOLKSWAGEN\",\"VOLVO\",\"WESTERN STAR\",\"WORKHORSE\",\"YAMAHA\",\"ALFA ROMEO\",\"AUTOCAR LLC.\",\"COUNTRY COACH MOTORHOME\",\"HUMMER\",\"KASEA\",\"LEM\",\"MASERATI\",\"MINI\",\"MORGAN\",\"SALEEN\",\"WESTERN RV\",\"MAYBACH\",\"ROVER\",\"VENTO\",\"FIAT\",\"JOHN DEERE\",\"KUBOTA\",\"SCION\",\"SMART\",\"VESPA\",\"HYOSUNG\",\"PIAGGIO\",\"ARGO\",\"BUGATTI\",\"PIERCE MFG. INC.\",\"AMERICAN LAFRANCE\",\"CAN-AM\",\"CRANE CARRIER\",\"CUB CADET\",\"BETA\",\"BOBCAT\",\"TESLA\",\"RAM\",\"VPG\",\"CODA\",\"FISKER\",\"MCLAREN\",\"SRT\",\"BERTONE\",\"IC CORPORATION\",\"NASH\")\n\nerror_code_list <- Error_code_list\n\n\n```\n\n\n\n\nColumn {.sidebar}\n-----------------------------------------------------------------------\n\nSelect period, operators and terminals below :\n\n\n```{r Car Make selection}\n\n\n      selectizeInput(\"car_make_selection\", label = \"Car Make:\",\n                        choices = car_makes_list, selected = \"BMW\",\n                     options = list(maxItems = 3, placeholder = 'please enter make here',multiple = TRUE))\n\n```\n\n```{r Error code selection}\n      selectInput(\"error_code_selection\", label = \"Error Code:\",\n                  choices = All_error_codes, selected = NULL,\n                  options = list(maxItems = 3, placeholder = 'please enter error codes here',multiple = TRUE))\n\n```\n\n```{r Error text selection }\n\n  selectizeInput(\"error_text_selection\",label = \"Error Text:\",\n                  choices = All_error_texts , selected = NULL,\n                 options = list(maxItems = 3, placeholder = 'please enter error text here',multiple = TRUE))\n\n```\n\n\n\n\n\nColumn   \n-----------------------------------------------------------------------\n\n### List of relevant files\n\n\n```{r Build table corresponding to search terms}\n\n# Handle cases when selection is blank\n\nbuild_query_result_table <- function(input_make_selection,input_error_code_selection,input_error_text_selection){\n  \n  if(length(input_make_selection) == 0){\n    \n        query_result_table <- features_df %>% \n           filter(input$car_make_selection == Vehicle_make &&\n           input$error_code_selection %in% Error_code_list &&\n           input$error_text_selection %in% Error_text_list)\n    \n  }\n  \n  if(length(input_make_selection) == 0){\n    \n        query_result_table <- features_df %>% \n           filter(input$car_make_selection == Vehicle_make &&\n           input$error_code_selection %in% Error_code_list &&\n           input$error_text_selection %in% Error_text_list)\n    \n  }\n  \n  if(length(input_make_selection) == 0){\n    \n        query_result_table <- features_df %>% \n           filter(input$car_make_selection == Vehicle_make &&\n           input$error_code_selection %in% Error_code_list &&\n           input$error_text_selection %in% Error_text_list)\n    \n  }\n  \n  \n}\nrenderDataTable({\n\n  #Subset data frame based on user selection  \n  \n  \n\n \n \n # Build and Display in DT\n \n dt <- datatable(query_result_table)\n \n return(dt)\n \n\n})\n\n",
    "created" : 1506008707097.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "886509932",
    "id" : "A40F8603",
    "lastKnownWriteTime" : 1506012371,
    "last_content_update" : 1506012371248,
    "path" : "~/Dropbox/Autel/App_Autel.Rmd",
    "project_path" : "App_Autel.Rmd",
    "properties" : {
        "last_setup_crc32" : "317697ADbb338d19",
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}